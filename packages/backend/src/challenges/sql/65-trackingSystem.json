{
    "rating": 8,
    "tests": [
        {
            "scripts": [
                "DROP TABLE IF EXISTS tracks CASCADE;",
                "CREATE TABLE tracks (received_at TEXT, event_name TEXT, anonymous_id INTEGER, user_id INTEGER);",
                "INSERT INTO tracks VALUES ('2016-01-01 12:13:12', 'buttonClicked', 1, NULL), ('2016-01-02 12:14:15', 'pageReloaded', 3, NULL), ('2016-02-02 13:15:13', 'pageRendered', 2, NULL), ('2016-02-03 13:15:23', 'commentWritten', 3, NULL), ('2016-03-03 14:15:15', 'avatarUpdated', 2, 2), ('2016-03-04 14:15:24', 'statusUpdated', 1, 1);"
            ],
            "expectedOutput": [
                {
                    "anonym_id": 1,
                    "last_null": "buttonClicked",
                    "first_notnull": "statusUpdated"
                },
                {
                    "anonym_id": 2,
                    "last_null": "pageRendered",
                    "first_notnull": "avatarUpdated"
                },
                {
                    "anonym_id": 3,
                    "last_null": "commentWritten",
                    "first_notnull": null
                }
            ]
        },
        {
            "scripts": [
                "DROP TABLE IF EXISTS tracks CASCADE;",
                "CREATE TABLE tracks (received_at TEXT, event_name TEXT, anonymous_id INTEGER, user_id INTEGER);",
                "INSERT INTO tracks VALUES ('2017-01-01 09:00:00', 'pageViewed', 10, 5), ('2017-01-01 09:05:00', 'buttonClicked', 11, NULL), ('2017-01-01 09:06:00', 'formOpened', 11, NULL), ('2017-01-01 09:10:00', 'loggedIn', 11, 7), ('2017-01-01 10:00:00', 'pageViewed', 12, NULL);"
            ],
            "expectedOutput": [
                {
                    "anonym_id": 10,
                    "last_null": null,
                    "first_notnull": "pageViewed"
                },
                {
                    "anonym_id": 11,
                    "last_null": "formOpened",
                    "first_notnull": "loggedIn"
                },
                {
                    "anonym_id": 12,
                    "last_null": "pageViewed",
                    "first_notnull": null
                }
            ]
        }
    ]
}