{
    "additionalTitle": "JOIN - Advanced",
    "rating": 8,
    "tests": [
        {
            "scripts": [
                "DROP TABLE IF EXISTS movies CASCADE;",
                "CREATE TABLE movies (movie TEXT, genre TEXT);",
                "INSERT INTO movies VALUES ('Don''t Breathe', 'crime movie'), ('Drive', 'crime movie'), ('Enemy', 'thriller'), ('Mulholland Drive', 'mystery'), ('Nocturnal Animals', 'thriller'), ('The Neon Demon', 'thriller');",
                "DROP TABLE IF EXISTS starring_actors CASCADE;",
                "CREATE TABLE starring_actors (id INTEGER, movie_name TEXT, actor TEXT);",
                "INSERT INTO starring_actors VALUES (1, 'Drive', 'Ryan Gosling'), (2, 'Drive', 'Carey Mulligan'), (3, 'Don''t Breathe', 'Dylan Minnette'), (4, 'Enemy', 'Jake Gyllenhaal'), (5, 'Enemy', 'Sarah Gadon'), (6, 'Mulholland Drive', 'Naomi Watts'), (7, 'Mulholland Drive', 'Laura Harring'), (8, 'Nocturnal Animals', 'Amy Adams'), (9, 'Nocturnal Animals', 'Aaron Taylor-Johnson'), (10, 'Nocturnal Animals', 'Michael Shannon'), (11, 'The Neon Demon', 'Elle Fanning'), (12, 'The Neon Demon', 'Keanu Reeves');",
                "DROP TABLE IF EXISTS actor_ages CASCADE;",
                "CREATE TABLE actor_ages (actor TEXT, age INTEGER);",
                "INSERT INTO actor_ages VALUES ('Aaron Taylor-Johnson', 26), ('Amy Adams', 42), ('Carey Mulligan', 31), ('Dylan Minnette', 19), ('Elle Fanning', 18), ('Jake Gyllenhaal', 36), ('Keanu Reeves', 52), ('Laura Harring', 52), ('Michael Shannon', 42), ('Naomi Watts', 48), ('Ryan Gosling', 36), ('Sarah Gadon', 29);"
            ],
            "expectedOutput": [
                {
                    "actor": "Keanu Reeves",
                    "age": 52
                },
                {
                    "actor": "Amy Adams",
                    "age": 42
                },
                {
                    "actor": "Michael Shannon",
                    "age": 42
                },
                {
                    "actor": "Jake Gyllenhaal",
                    "age": 36
                },
                {
                    "actor": "Sarah Gadon",
                    "age": 29
                },
                {
                    "actor": "Aaron Taylor-Johnson",
                    "age": 26
                },
                {
                    "actor": "Elle Fanning",
                    "age": 18
                }
            ]
        },
        {
            "scripts": [
                "DROP TABLE IF EXISTS movies CASCADE;",
                "CREATE TABLE movies (movie TEXT, genre TEXT);",
                "INSERT INTO movies VALUES ('The Dark Knight', 'action'), ('Inception', 'sci-fi'), ('Se7en', 'thriller'), ('Gone Girl', 'thriller'), ('The Prestige', 'mystery'), ('Shutter Island', 'mystery');",
                "DROP TABLE IF EXISTS starring_actors CASCADE;",
                "CREATE TABLE starring_actors (id INTEGER, movie_name TEXT, actor TEXT);",
                "INSERT INTO starring_actors VALUES (1, 'The Dark Knight', 'Christian Bale'), (2, 'The Dark Knight', 'Heath Ledger'), (3, 'Inception', 'Leonardo DiCaprio'), (4, 'Inception', 'Joseph Gordon-Levitt'), (5, 'Se7en', 'Brad Pitt'), (6, 'Se7en', 'Morgan Freeman'), (7, 'Gone Girl', 'Ben Affleck'), (8, 'Gone Girl', 'Rosamund Pike'), (9, 'The Prestige', 'Hugh Jackman'), (10, 'The Prestige', 'Christian Bale'), (11, 'Shutter Island', 'Leonardo DiCaprio'), (12, 'Shutter Island', 'Mark Ruffalo');",
                "DROP TABLE IF EXISTS actor_ages CASCADE;",
                "CREATE TABLE actor_ages (actor TEXT, age INTEGER);",
                "INSERT INTO actor_ages VALUES ('Ben Affleck', 48), ('Brad Pitt', 57), ('Christian Bale', 47), ('Heath Ledger', 28), ('Hugh Jackman', 52), ('Joseph Gordon-Levitt', 40), ('Leonardo DiCaprio', 46), ('Mark Ruffalo', 53), ('Morgan Freeman', 83), ('Rosamund Pike', 42);"
            ],
            "expectedOutput": [
                {
                    "actor": "Morgan Freeman",
                    "age": 83
                },
                {
                    "actor": "Mark Ruffalo",
                    "age": 53
                },
                {
                    "actor": "Brad Pitt",
                    "age": 57
                },
                {
                    "actor": "Hugh Jackman",
                    "age": 52
                },
                {
                    "actor": "Christian Bale",
                    "age": 47
                },
                {
                    "actor": "Leonardo DiCaprio",
                    "age": 46
                },
                {
                    "actor": "Rosamund Pike",
                    "age": 42
                },
                {
                    "actor": "Joseph Gordon-Levitt",
                    "age": 40
                },
                {
                    "actor": "Ben Affleck",
                    "age": 48
                }
            ]
        }
    ]
}